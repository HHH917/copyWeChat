{"version":3,"sources":["uni-app:///main.js",null,"webpack:///E:/package/uniAPP添加设备(小程序)/copyWeChat/pages/chat/chat/chat.nvue?5168","webpack:///E:/package/uniAPP添加设备(小程序)/copyWeChat/pages/chat/chat/chat.nvue?5081","webpack:///E:/package/uniAPP添加设备(小程序)/copyWeChat/pages/chat/chat/chat.nvue?5d5e","uni-app:///pages/chat/chat/chat.nvue","webpack:///E:/package/uniAPP添加设备(小程序)/copyWeChat/pages/chat/chat/chat.nvue?268b","webpack:///E:/package/uniAPP添加设备(小程序)/copyWeChat/pages/chat/chat/chat.nvue?5bb7","webpack:///E:/package/uniAPP添加设备(小程序)/copyWeChat/pages/chat/chat/chat.nvue?a4cf","webpack:///E:/package/uniAPP添加设备(小程序)/copyWeChat/pages/chat/chat/chat.nvue?2029"],"names":["createPage","Page"],"mappings":"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SAtLA,qBAsLA;;;;AAIA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAZA;AAaA;;AAEA;AACA;AACA;AACA;AACA;AACA,gCADA;;AAGA;AACA,KAPA;AAQA,GArNA;AAsNA;AACA;AACA,+DADA;AAEA,2EAFA,GADA;;AAKA;AACA,cANA,wBAMA;AACA;AACA,KARA;;AAUA;AACA,kBAXA,4BAWA;AACA;AACA;AACA,KAdA;AAeA;AACA,iBAhBA,2BAgBA;AACA;AACA,KAlBA;AAmBA;AACA,YApBA,sBAoBA;AACA;AACA;AACA;AACA,iEADA;AAEA;AACA,KA1BA;AA2BA;AACA,aA5BA,uBA4BA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA,OANA;AAOA,KApCA;AAqCA;AACA,kBAtCA,4BAsCA;AACA;AACA,uBADA;;AAGA,KA1CA;AA2CA;AACA,wBA5CA,kCA4CA;AACA;AACA;AACA,8BADA;AAEA,QAHA;AAIA;AACA;AACA,KAnDA;AAoDA;AACA,aArDA,uBAqDA;AACA;AACA;AACA;AACA;AACA;AACA,OAJA;AAKA;AACA,KA7DA,GAtNA;;AAqRA;AACA,QADA,gBACA,QADA,EACA,QADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KARA,EArRA;;AA+RA,SA/RA,qBA+RA;AACA;AACA;AACA,GAlSA;AAmSA;AACA,gDADA;AAEA,UAFA,oBAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCADA;AAEA;AACA;AACA,qBADA;AAEA,kBALA;AAMA,iCANA;;AAQA;AACA;AACA;AACA,KAzBA;AA0BA;AACA,wBA3BA,kCA2BA;AACA;AACA;AACA;AACA;AACA;AACA,KAjCA;AAkCA;AACA,aAnCA,uBAmCA;AACA;AACA;AACA,KAtCA;AAuCA;AACA,gBAxCA,0BAwCA;AACA;AACA,KA1CA;AA2CA;AACA,QA5CA,gBA4CA,IA5CA,EA4CA;AACA;AACA,gDADA;AAEA,kBAFA;AAGA,sBAHA;AAIA,kBAJA,EAIA;AACA,kBALA;AAMA,wBANA;AAOA,yCAPA;AAQA,uBARA;;AAUA;AACA;AACA;AACA,gBAHA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAnEA;AAoEA;;AAEA,gBAtEA,0BAsEA;AACA;;;;;;;;;;;AAWA;AACA;AACA;;AAEA;AACA,OAhBA,EAgBA,GAhBA;AAiBA,KAxFA;AAyFA;AACA,QA1FA,sBA0FA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAlGA;AAmGA;AACA,cApGA,sBAoGA,KApGA,EAoGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBARA;;AAUA;AACA;AACA,KAjHA;AAkHA;AACA,eAnHA,uBAmHA,CAnHA,EAmHA;AACA;AACA;AACA;AACA,oBADA;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAFA;AAGA,aAVA;;AAYA;AACA;AACA;AACA,2BADA;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,aATA;;AAWA;AACA;AACA;AACA;AACA,gBA/BA;;AAiCA,KArJA;AAsJA;AACA,iBAvJA,yBAuJA,GAvJA,EAuJA;AACA;AACA,oBADA;AAEA,4BAFA;AAGA,4BAHA;;AAKA,KA7JA;AA8JA;AACA,qBA/JA,+BA+JA;AACA;AACA,KAjKA;AAkKA;AACA,mBAnKA,2BAmKA,CAnKA,EAmKA;AACA;AACA;AACA;AACA,8DADA;AAEA;AACA;AACA;AACA,qBADA;;AAGA,KA7KA;AA8KA;AACA,iBA/KA,2BA+KA;AACA;AACA;AACA;AACA,KAnLA;AAoLA;AACA,oBArLA,8BAqLA;AACA;AACA;AACA;AACA;AACA,KA1LA;AA2LA,kBA3LA,0BA2LA,CA3LA,EA2LA;AACA;AACA,8DADA;AAEA;AACA;AACA,KAhMA;AAiMA;AACA,eAlMA,yBAkMA;AACA;AACA,mCADA;;AAGA,KAtMA,GAnSA,E;;;;;;;;;;;;;AC3OA;AAAA;AAAA;AAAA;AAAmkC,CAAgB,iiCAAG,EAAC,C;;;;;;;;;;;ACAvlC;AACA,OAAO,KAAU,EAAE,kBAKd;;;;;;;;;;;;;ACNL;AAAA;AAAA;AAAA;AAA2lC,CAAgB,yjCAAG,EAAC,C;;;;;;;;;;;ACA/mC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/chat/chat/chat.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/chat/chat/chat.nvue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./chat.nvue?vue&type=template&id=411c1acd&scoped=true&\"\nvar renderjs\nimport script from \"./chat.nvue?vue&type=script&lang=js&\"\nexport * from \"./chat.nvue?vue&type=script&lang=js&\"\nimport style0 from \"./chat.nvue?vue&type=style&index=0&lang=css&\"\nimport style1 from \"./chat.nvue?vue&type=style&index=1&id=411c1acd&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"411c1acd\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/chat/chat/chat.nvue\"\nexport default component.exports","export * from \"-!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.nvue?vue&type=template&id=411c1acd&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function($event) {\n      _vm.mode = \"text\"\n    }\n\n    _vm.e1 = function($event) {\n      _vm.KeyboardHeight = 0\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.nvue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.nvue?vue&type=script&lang=js&\"","<style>\n  view,\n  label,\n  swiper-item,\n  scroll-view {\n    display:flex;\n    flex-direction:column;\n    flex-shrink: 0;\n    flex-grow: 0;\n    flex-basis: auto;\n    align-items: stretch;\n    align-content: flex-start;\n  }\n  view,\n  image,\n  input,\n  scroll-view,\n  swiper,\n  swiper-item,\n  text,\n  textarea,\n  video {\n    position: relative;\n    border: 0px solid #000000;\n    box-sizing: border-box;\n  }\n  swiper-item {\n    position: absolute;\n  }\n  button {\n    margin: 0;\n  }\n</style>\n<template>\r\n\t<div>\r\n\t\t<!-- 导航栏 -->\r\n\t\t<free-nav-bar title=\"HHH博客\" :noreadnum=\"1\" :fixed=\"true\" showBack>\r\n\t\t\t<free-icon-button slot=\"right\" :icon=\"'\\ue6fd'\" @click=\"openChatSet\"></free-icon-button>\r\n\t\t</free-nav-bar>\r\n\t\t<!-- 聊天内容区域 -->\r\n\t\t<scroll-view\r\n\t\t\tscroll-y=\"true\"\r\n\t\t\tclass=\" hiddenScrollbar bg-light position-fixed left-0 right-0 px-3\"\r\n\t\t\tstyle=\"bottom: 105rpx;\"\r\n\t\t\t:style=\"chatBodyBottom\"\r\n\t\t\t:show-scrollbar=\"false\"\r\n\t\t\t:scroll-into-view=\"scrollIntoView\"\r\n\t\t\t:scroll-with-animation=\"true\"\r\n\t\t\t@click=\"clickPage\"\r\n\t\t>\r\n\t\t\t<!-- 聊天信息列表组件 -->\r\n\t\t\t<view\r\n\t\t\t\tv-for=\"(item, index) in list\"\r\n\t\t\t\t:key=\"index\"\r\n\t\t\t\t:id=\"'chatItem_' + index\"\r\n\t\t\t>\r\n\t\t\t\t<free-chat-item\r\n\t\t\t\t\t:item=\"item\"\r\n\t\t\t\t\t:index=\"index\"\r\n\t\t\t\t\tref=\"chatItem\"\r\n\t\t\t\t\t@long=\"long\"\r\n\t\t\t\t\t@preview=\"previewImages\"\r\n\t\t\t\t\t:pretime=\"index > 0 ? list[index - 1].create_time : 0\"\r\n\t\t\t\t></free-chat-item>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t\t<!-- #ifdef APP-NVUE -->\r\n\t\t<div\r\n\t\t\tv-if=\"mode === 'action' || mode === 'emoticon'\"\r\n\t\t\tclass=\"position-fixed top-0 right-0 left-0 bottom-0\"\r\n\t\t\t:style=\"'bottom:' + maskBottom + 'px'\"\r\n\t\t\t@click=\"clickPage\"\r\n\t\t></div>\r\n\t\t<!-- #endif -->\r\n\r\n\t\t<!-- 底部输入框 -->\r\n\t\t<view\r\n\t\t\tclass=\"position-fixed left-0 right-0  border-top flex align-center \"\r\n\t\t\tstyle=\"background-color: #f7f7f6;height: 105rpx;\"\r\n\t\t\t:style=\"'bottom:' + KeyboardHeight + 'px'\"\r\n\t\t>\r\n\t\t\t<free-icon-button\r\n\t\t\t\tv-if=\"mode === 'audio'\"\r\n\t\t\t\t:icon=\"'\\ue607'\"\r\n\t\t\t\t@click=\"changeVoiceOrText\"\r\n\t\t\t></free-icon-button>\r\n\t\t\t<free-icon-button\r\n\t\t\t\tv-else\r\n\t\t\t\t:icon=\"'\\ue606'\"\r\n\t\t\t\t@click=\"changeVoiceOrText\"\r\n\t\t\t></free-icon-button>\r\n\t\t\t<view class=\"flex-1\">\r\n\t\t\t\t<view\r\n\t\t\t\t\tv-if=\"mode === 'audio'\"\r\n\t\t\t\t\tclass=\" rounded flex align-center justify-center\"\r\n\t\t\t\t\tstyle=\"height: 80rpx;\"\r\n\t\t\t\t\t:class=\"isRecording ? 'bg-hover-light' : 'bg-white'\"\r\n\t\t\t\t\t@touchstart=\"voiceTouchStart\"\r\n\t\t\t\t\t@touchend=\"voiceTouchEnd\"\r\n\t\t\t\t\t@touchcancel=\"voiceTouchCancel\"\r\n\t\t\t\t\t@touchmove=\"voiceTouchMove\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<text class=\"font\">\r\n\t\t\t\t\t\t{{ isRecording ? '松开 结束' : '按住 说话' }}\r\n\t\t\t\t\t</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<textarea\r\n\t\t\t\t\tv-else\r\n\t\t\t\t\tfixed\r\n\t\t\t\t\tclass=\" bg-white rounded p-2\"\r\n\t\t\t\t\tstyle=\"height: 80rpx; width: auto;\"\r\n\t\t\t\t\t:adjust-position=\"false\"\r\n\t\t\t\t\tv-model=\"text\"\r\n\t\t\t\t\t@focus=\"mode = 'text'\"\r\n\t\t\t\t/>\r\n\t\t\t</view>\r\n\t\t\t<!-- 表情 -->\r\n\t\t\t<free-icon-button\r\n\t\t\t\t:icon=\"'\\ue605'\"\r\n\t\t\t\t@click=\"openActionOrEmoticon('emoticon')\"\r\n\t\t\t></free-icon-button>\r\n\r\n\t\t\t<template v-if=\"text.length === 0\">\r\n\t\t\t\t<!-- 扩展菜单 -->\r\n\t\t\t\t<free-icon-button\r\n\t\t\t\t\t:icon=\"'\\ue603'\"\r\n\t\t\t\t\t@click=\"openActionOrEmoticon('action')\"\r\n\t\t\t\t></free-icon-button>\r\n\t\t\t</template>\r\n\t\t\t<template v-else>\r\n\t\t\t\t<!-- 发送按钮 -->\r\n\t\t\t\t<view\r\n\t\t\t\t\tclass=\"main-bg-color  rounded mr-3 px-2 py-1\"\r\n\t\t\t\t\thover-class=\"\"\r\n\t\t\t\t\t@click=\"send('text')\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<text class=\"font text-white \">发送</text>\r\n\t\t\t\t</view>\r\n\t\t\t</template>\r\n\t\t</view>\r\n\t\t<!-- 扩展菜单弹出层 -->\r\n\t\t<free-popup\r\n\t\t\tref=\"action\"\r\n\t\t\tbottom\r\n\t\t\ttransformOrigin=\"center bottom\"\r\n\t\t\t@hide=\"KeyboardHeight = 0\"\r\n\t\t\t:mask=\"false\"\r\n\t\t>\r\n\t\t\t<view\r\n\t\t\t\tstyle=\"height: 580rpx;\"\r\n\t\t\t\tclass=\"border-top border-light-secondary bg-light\"\r\n\t\t\t>\r\n\t\t\t\t<swiper :indicator-dots=\"indicatorDots\" style=\"height: 510rpx;\">\r\n\t\t\t\t\t<swiper-item\r\n\t\t\t\t\t\tclass=\"row\"\r\n\t\t\t\t\t\tv-for=\"(item, index) in emoticonOrAcitonList\"\r\n\t\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<view\r\n\t\t\t\t\t\t\tclass=\"col-3 flex flex-column align-center justify-center\"\r\n\t\t\t\t\t\t\tstyle=\"height:255rpx;\"\r\n\t\t\t\t\t\t\tv-for=\"(item2, index2) in item\"\r\n\t\t\t\t\t\t\t:key=\"index2\"\r\n\t\t\t\t\t\t\t@click=\"actionEvent(item2)\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<image\r\n\t\t\t\t\t\t\t\t:src=\"item2.icon\"\r\n\t\t\t\t\t\t\t\tmode=\"widthFix\"\r\n\t\t\t\t\t\t\t\tstyle=\"width:100rpx;height: 100rpx;\"\r\n\t\t\t\t\t\t\t></image>\r\n\t\t\t\t\t\t\t<text class=\"font-sm text-muted mt-2\">\r\n\t\t\t\t\t\t\t\t{{ item2.name }}\r\n\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</swiper-item>\r\n\t\t\t\t</swiper>\r\n\t\t\t</view>\r\n\t\t</free-popup>\r\n\r\n\t\t<!-- 弹出层 -->\r\n\t\t<free-popup\r\n\t\t\tref=\"extend\"\r\n\t\t\t:bodyWidth=\"300\"\r\n\t\t\t:bodyHeight=\"getMenusHeight\"\r\n\t\t\t:tabbarHeight=\"105\"\r\n\t\t>\r\n\t\t\t<view\r\n\t\t\t\tclass=\"flex flex-column\"\r\n\t\t\t\tstyle=\"width: 240rpx;\"\r\n\t\t\t\t:style=\"getMenusStyle\"\r\n\t\t\t>\r\n\t\t\t\t<view\r\n\t\t\t\t\tclass=\"flex-1 flex align-center\"\r\n\t\t\t\t\thover-class=\"bg-light\"\r\n\t\t\t\t\tv-for=\"(item, index) in menusList\"\r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t@click=\"clickEvent(item.event)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<text class=\"font-md pl-3\">{{ item.name }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</free-popup>\r\n\r\n\t\t<!-- 录音提示 -->\r\n\t\t<view\r\n\t\t\tv-if=\"isRecording\"\r\n\t\t\tclass=\"position-fixed top-0 left-0 right-0 flex align-center justify-center\"\r\n\t\t\tstyle=\"bottom:105rpx;\"\r\n\t\t>\r\n\t\t\t<view\r\n\t\t\t\tclass=\"rounded flex flex-column align-center justify-center\"\r\n\t\t\t\tstyle=\"background-color: rgba(0,0,0,0.5); width: 360rpx;height: 360rpx;\"\r\n\t\t\t>\r\n\t\t\t\t<image\r\n\t\t\t\t\tsrc=\"/static/audio/recording.gif\"\r\n\t\t\t\t\tstyle=\"width: 150rpx; height: 150rpx;\"\r\n\t\t\t\t></image>\r\n\t\t\t\t<text class=\"font text-white mt-3\">\r\n\t\t\t\t\t{{ unRecord ? '松开手指,取消发送' : '手指上滑,取消发送' }}\r\n\t\t\t\t</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n// #ifdef APP-NVUE\r\nconst dom = weex.requireModule('dom');\r\n// #endif\r\n\r\nimport freeNavBar from '@/components/free-ui/free-nav-bar.vue';\r\nimport freeIconButton from '@/components/free-ui/free-icon-button.vue';\r\nimport freeChatItem from '@/components/free-ui/free-chat-item.vue';\r\nimport freePopup from '@/components/free-ui/free-popup.vue';\r\nimport { mapState, mapMutations } from 'vuex';\r\nexport default {\r\n\tcomponents: {\r\n\t\tfreeNavBar,\r\n\t\tfreeIconButton,\r\n\t\tfreeChatItem,\r\n\t\tfreePopup\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\t//模式 text 输入文字 emoitcon表情 action 操作 audio音频\r\n\t\t\tmode: 'audio',\r\n\t\t\t// 扩展菜单列表\r\n\t\t\tactionList: [\r\n\t\t\t\t[\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: '相册',\r\n\t\t\t\t\t\ticon: '/static/images/extends/pic.png',\r\n\t\t\t\t\t\tevent: 'uploadImage'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: '拍摄',\r\n\t\t\t\t\t\ticon: '/static/images/extends/video.png',\r\n\t\t\t\t\t\tevent: 'uploadVideo'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: '收藏',\r\n\t\t\t\t\t\ticon: '/static/images/extends/shoucan.png',\r\n\t\t\t\t\t\tevent: ''\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: '名片',\r\n\t\t\t\t\t\ticon: '/static/images/extends/man.png',\r\n\t\t\t\t\t\tevent: ''\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: '语音通话',\r\n\t\t\t\t\t\ticon: '/static/images/extends/phone.png',\r\n\t\t\t\t\t\tevent: ''\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: '位置',\r\n\t\t\t\t\t\ticon: '/static/images/extends/path.png',\r\n\t\t\t\t\t\tevent: ''\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t],\r\n\t\t\temoticonList: [\r\n\t\t\t\t// [\r\n\t\t\t\t// \t{\r\n\t\t\t\t// \t\tname: '沮丧',\r\n\t\t\t\t// \t\ticon: '/static/images/emoticon/5497/0.gif',\r\n\t\t\t\t// \t\tevent: ''\r\n\t\t\t\t// \t}\r\n\t\t\t\t// ]\r\n\t\t\t],\r\n\t\t\t//键盘高度\r\n\t\t\tKeyboardHeight: 0,\r\n\t\t\tmenus: [\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '复制',\r\n\t\t\t\t\tevent: ''\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '发送给朋友',\r\n\t\t\t\t\tevent: ''\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '收藏',\r\n\t\t\t\t\tevent: ''\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '删除',\r\n\t\t\t\t\tevent: ''\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '多选',\r\n\t\t\t\t\tevent: ''\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '撤回',\r\n\t\t\t\t\tevent: 'removeChatItem'\r\n\t\t\t\t}\r\n\t\t\t],\r\n\r\n\t\t\tscrollIntoView: '',\r\n\t\t\t// 是否显示指示灯\r\n\t\t\tindicatorDots: true,\r\n\t\t\t// 当前操作的气泡索引\r\n\t\t\tpropIndex: -1,\r\n\t\t\t// 音频录制状态\r\n\t\t\tisRecording: false,\r\n\t\t\tRecordingStartY: 0,\r\n\t\t\t// 取消录音\r\n\t\t\tunRecord: false,\r\n\r\n\t\t\tnavBarHeight: 0,\r\n\t\t\tstatusBarHeight: 0,\r\n\r\n\t\t\tlist: [\r\n\t\t\t\t{\r\n\t\t\t\t\tavatar: '/static/images/mail/friend.png',\r\n\t\t\t\t\tuser_id: 1,\r\n\t\t\t\t\tnickname: '昵称',\r\n\t\t\t\t\ttype: 'text', //image,audio,video,file,share\r\n\t\t\t\t\tdata:\r\n\t\t\t\t\t\t'你好,ヽ(*^ｰ^)人(^ｰ^*)ノ你好,ヽ(*^ｰ^)人(^ｰ^*)ノ你好,ヽ(*^ｰ^)人(^ｰ^*)ノ你好,ヽ(*^ｰ^)人(^ｰ^*)ノ',\r\n\t\t\t\t\tcreate_time: 1616741674,\r\n\t\t\t\t\tisremove: true\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tavatar: '/static/images/mail/friend.png',\r\n\t\t\t\t\tuser_id: 2,\r\n\t\t\t\t\tnickname: '昵称',\r\n\t\t\t\t\ttype: 'text', //image,audio,video,file,share\r\n\t\t\t\t\tdata:\r\n\t\t\t\t\t\t'你好,ヽ(*^ｰ^)人(^ｰ^*)ノ你好,ヽ(*^ｰ^)人(^ｰ^*)ノ你好,ヽ(*^ｰ^)人(^ｰ^*)ノ你好,ヽ(*^ｰ^)人(^ｰ^*)ノ',\r\n\t\t\t\t\tcreate_time: 1616742034,\r\n\t\t\t\t\tisremove: false\r\n\t\t\t\t},\r\n\r\n\t\t\t\t{\r\n\t\t\t\t\tavatar: '/static/images/mail/friend.png',\r\n\t\t\t\t\tuser_id: 1,\r\n\t\t\t\t\tnickname: '昵称',\r\n\t\t\t\t\ttype: 'text', //image,audio,video,file,share\r\n\t\t\t\t\tdata:\r\n\t\t\t\t\t\t'你好,ヽ(*^ｰ^)人(^ｰ^*)ノ你好,ヽ(*^ｰ^)人(^ｰ^*)ノ你好,ヽ(*^ｰ^)人(^ｰ^*)ノ你好,ヽ(*^ｰ^)人(^ｰ^*)ノ',\r\n\t\t\t\t\tcreate_time: 1616742034,\r\n\t\t\t\t\tisremove: false\r\n\t\t\t\t},\r\n\r\n\t\t\t\t{\r\n\t\t\t\t\tavatar: '/static/images/mail/friend.png',\r\n\t\t\t\t\tuser_id: 2,\r\n\t\t\t\t\tnickname: '昵称',\r\n\t\t\t\t\ttype: 'text', //image,audio,video,file,share\r\n\t\t\t\t\tdata:\r\n\t\t\t\t\t\t'你好,ヽ(*^ｰ^)人(^ｰ^*)ノ你好,ヽ(*^ｰ^)人(^ｰ^*)ノ你好,ヽ(*^ｰ^)人(^ｰ^*)ノ你好,ヽ(*^ｰ^)人(^ｰ^*)ノ',\r\n\t\t\t\t\tcreate_time: 1616742034,\r\n\t\t\t\t\tisremove: false\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tavatar: '/static/images/mail/friend.png',\r\n\t\t\t\t\tuser_id: 2,\r\n\t\t\t\t\tnickname: '昵称',\r\n\t\t\t\t\ttype: 'audio', //image,audio,video,file,share\r\n\t\t\t\t\tdata: '/static/audio/1.mp3',\r\n\t\t\t\t\toptions: {\r\n\t\t\t\t\t\ttime: 10\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcreate_time: 1616742034,\r\n\t\t\t\t\tisremove: false\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tavatar: '/static/images/mail/friend.png',\r\n\t\t\t\t\tuser_id: 2,\r\n\t\t\t\t\tnickname: '昵称',\r\n\t\t\t\t\ttype: 'video', //image,audio,video,file,share\r\n\t\t\t\t\tdata: '/static/video/demo.mp4',\r\n\t\t\t\t\toptions: {\r\n\t\t\t\t\t\tposter: '/static/video/demo.jpg'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcreate_time: 1616742034,\r\n\t\t\t\t\tisremove: false\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tavatar: '/static/images/mail/friend.png',\r\n\t\t\t\t\tuser_id: 1,\r\n\t\t\t\t\tnickname: '昵称',\r\n\t\t\t\t\ttype: 'video', //image,audio,video,file,share\r\n\t\t\t\t\tdata: '/static/video/demo.mp4',\r\n\t\t\t\t\toptions: {\r\n\t\t\t\t\t\tposter: '/static/video/demo.jpg'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcreate_time: 1616742034,\r\n\t\t\t\t\tisremove: false\r\n\t\t\t\t}\r\n\t\t\t],\r\n\r\n\t\t\ttext: '' //输入文字\r\n\t\t};\r\n\t},\r\n\tmounted() {\r\n\t\t// #ifdef APP-PLUS-NVUE\r\n\t\tthis.statusBarHeight = plus.navigator.getStatusbarHeight();\r\n\t\t// #endif\r\n\t\tthis.navBarHeight = this.statusBarHeight + uni.upx2px(90);\r\n\r\n\t\t// 监听键盘高度变化\r\n\t\tuni.onKeyboardHeightChange(res => {\r\n\t\t\t// 修复@foucus 事件触发比 onKeyboardHeightChange键盘高度变化监听慢的bug;\r\n\t\t\tif (res.height > 0) {\r\n\t\t\t\tthis.mode = 'text';\r\n\t\t\t}\r\n\t\t\tif (this.mode !== 'action' && this.mode !== 'emoticon') {\r\n\t\t\t\tthis.KeyboardHeight = res.height;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.KeyboardHeight > 0) {\r\n\t\t\t\tthis.pageToBottom();\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.pageToBottom();\r\n\r\n\t\t// 注册发送音频事件\r\n\t\tthis.regSendVoiceEvent(url => {\r\n\t\t\tif (!this.unRecord) {\r\n\t\t\t\t//发送\r\n\t\t\t\tthis.send('audio', url, {\r\n\t\t\t\t\ttime: this.RecordTime\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState({\r\n\t\t\tRECORD: state => state.audio.RECORD,\r\n\t\t\tRecordTime: state => state.audio.RecordTime\r\n\t\t}),\r\n\t\t// 动态获取蒙版的位置\r\n\t\tmaskBottom() {\r\n\t\t\treturn this.KeyboardHeight + uni.upx2px(105);\r\n\t\t},\r\n\r\n\t\t// 动态获取菜单高度\r\n\t\tgetMenusHeight() {\r\n\t\t\tlet H = 100;\r\n\t\t\treturn this.menus.length * H;\r\n\t\t},\r\n\t\t// 获取菜单的样式\r\n\t\tgetMenusStyle() {\r\n\t\t\treturn ` height:${this.getMenusHeight}rpx;`;\r\n\t\t},\r\n\t\t//判断是否操作本人信息\r\n\t\tisdoSelf() {\r\n\t\t\t// 获取本人id (假设拿到了)\r\n\t\t\tlet id = 1;\r\n\t\t\tlet user_id =\r\n\t\t\t\tthis.propIndex > -1 ? this.list[this.propIndex].user_id : 0;\r\n\t\t\treturn user_id === id;\r\n\t\t},\r\n\t\t// 获取操作菜单\r\n\t\tmenusList() {\r\n\t\t\treturn this.menus.filter(v => {\r\n\t\t\t\tif (v.name === '撤回' && !this.isdoSelf) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 聊天区域bottom\r\n\t\tchatBodyBottom() {\r\n\t\t\treturn `bottom:${uni.upx2px(105) + this.KeyboardHeight}px;top:${\r\n\t\t\t\tthis.navBarHeight\r\n\t\t\t}px;`;\r\n\t\t},\r\n\t\t// 获取操作或者表情列表\r\n\t\temoticonOrAcitonList() {\r\n\t\t\tlet list =\r\n\t\t\t\tthis.mode === 'emoticon' || this.mode === 'action'\r\n\t\t\t\t\t? this[this.mode + 'List']\r\n\t\t\t\t\t: [];\r\n\t\t\tthis.indicatorDots = list.length > 1;\r\n\t\t\treturn list;\r\n\t\t},\r\n\t\t// 所以信息的图片地址\r\n\t\timageList() {\r\n\t\t\tlet arr = [];\r\n\t\t\tthis.list.forEach(item => {\r\n\t\t\t\tif (item.type === 'emoticon' || item.type === 'image') {\r\n\t\t\t\t\tarr.push(item.data);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn arr;\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tmode(newValue, oldValue) {\r\n\t\t\tif (newValue !== 'action' && newValue !== 'emoticon') {\r\n\t\t\t\tthis.$refs.action.hide();\r\n\t\t\t}\r\n\t\t\tif (newValue !== 'text') {\r\n\t\t\t\tuni.hideKeyboard();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\t// 初始化\r\n\t\tthis.__init();\r\n\t},\r\n\tmethods: {\r\n\t\t...mapMutations(['regSendVoiceEvent']),\r\n\t\t__init() {\r\n\t\t\tlet total = 20;\r\n\t\t\tlet page = Math.ceil(total / 8);\r\n\t\t\tvar arr = [];\r\n\t\t\tfor (let i = 0; i < page; i++) {\r\n\t\t\t\tlet start = i * 8;\r\n\t\t\t\tarr[i] = [];\r\n\t\t\t\tfor (let j = 0; j < 8; j++) {\r\n\t\t\t\t\tlet no = start + j;\r\n\t\t\t\t\tif (no + 1 > total) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tarr[i].push({\r\n\t\t\t\t\t\tname: '表情' + (start + j),\r\n\t\t\t\t\t\ticon:\r\n\t\t\t\t\t\t\t'/static/images/emoticon/5497/' +\r\n\t\t\t\t\t\t\t(start + j) +\r\n\t\t\t\t\t\t\t'.gif',\r\n\t\t\t\t\t\tevent: 'sendEmoticon'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.emoticonList = arr;\r\n\t\t},\r\n\t\t// 打开扩展菜单或者表情包\r\n\t\topenActionOrEmoticon(mode = 'action') {\r\n\t\t\tthis.mode = mode;\r\n\t\t\tthis.$refs.action.show();\r\n\t\t\t// 收起键盘\r\n\t\t\tuni.hideKeyboard();\r\n\t\t\tthis.KeyboardHeight = uni.upx2px(580);\r\n\t\t},\r\n\t\t// 点击页面区域\r\n\t\tclickPage() {\r\n\t\t\tthis.mode = '';\r\n\t\t\t// this.$refs.action.hide();\r\n\t\t},\r\n\t\t// 输入框聚焦\r\n\t\tonInputFocus() {\r\n\t\t\tthis.mode = 'text';\r\n\t\t},\r\n\t\t// 发送\r\n\t\tsend(type, data = '', options = {}) {\r\n\t\t\tvar obj = {\r\n\t\t\t\tavatar: '/static/images/mail/friend.png',\r\n\t\t\t\tuser_id: 1,\r\n\t\t\t\tnickname: '昵称',\r\n\t\t\t\ttype: type, //image,audio,video,file,share,emoticon\r\n\t\t\t\tdata: data,\r\n\t\t\t\toptions: options,\r\n\t\t\t\tcreate_time: new Date().getTime(),\r\n\t\t\t\tisremove: false\r\n\t\t\t};\r\n\t\t\tswitch (type) {\r\n\t\t\t\tcase 'text':\r\n\t\t\t\t\tobj.data = this.text;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tthis.list.push(obj);\r\n\t\t\t// 发送文字成功,清空输入框\r\n\t\t\tif (type === 'text') {\r\n\t\t\t\tthis.text = '';\r\n\t\t\t}\r\n\t\t\t// 置于底部\r\n\t\t\tthis.pageToBottom();\r\n\t\t},\r\n\t\t// 回到底部\r\n\r\n\t\tpageToBottom() {\r\n\t\t\tlet timer = setTimeout(() => {\r\n\t\t\t\t// #ifdef APP-NVUE\r\n\t\t\t\tlet chatItem = this.$refs.chatItem;\r\n\t\t\t\tlet lastIndex = chatItem.length > 0 ? chatItem.length - 1 : 0;\r\n\t\t\t\tlet last = chatItem[lastIndex];\r\n\t\t\t\tif (last) {\r\n\t\t\t\t\tdom.scrollElement(last, {});\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\t// #ifndef APP-NVUE\r\n\t\t\t\tconsole.log('进入了');\r\n\t\t\t\tlet lastIndex = this.list.length - 1;\r\n\t\t\t\tthis.scrollIntoView = 'chatItem_' + lastIndex;\r\n\t\t\t\t// #endif\r\n\t\t\t\tclearTimeout(timer);\r\n\t\t\t}, 200);\r\n\t\t},\r\n\t\t// 长按气泡消息\r\n\t\tlong({ x, y, index }) {\r\n\t\t\t// 初始化 索引\r\n\t\t\tthis.propIndex = index;\r\n\t\t\t// 判断之前是否处于置顶状态\r\n\t\t\tlet item = this.list[index];\r\n\t\t\tthis.menus[0].name = item.istop ? '取消置顶' : '设为置顶';\r\n\r\n\t\t\tthis.$refs.extend.show(x, y);\r\n\t\t},\r\n\t\t// 操作菜单方法分发\r\n\t\tclickEvent(event) {\r\n\t\t\tswitch (event) {\r\n\t\t\t\tcase 'removeChatItem':\r\n\t\t\t\t\tif (this.propIndex > -1) {\r\n\t\t\t\t\t\tthis.list[this.propIndex].isremove = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\t//关闭菜单\r\n\t\t\tthis.$refs.extend.hide();\r\n\t\t},\r\n\t\t//扩展菜单\r\n\t\tactionEvent(e) {\r\n\t\t\tswitch (e.event) {\r\n\t\t\t\tcase 'uploadImage': // 选择相册\r\n\t\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\t\tcount: 9,\r\n\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\tconsole.log(res.tempFilePaths);\r\n\t\t\t\t\t\t\t// 发送到服务器\r\n\r\n\t\t\t\t\t\t\t// 渲染到页面\r\n\t\t\t\t\t\t\tres.tempFilePaths.forEach(item => {\r\n\t\t\t\t\t\t\t\tthis.send('image', item);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'uploadVideo': //发送视频\r\n\t\t\t\t\tuni.chooseVideo({\r\n\t\t\t\t\t\tmaxDuration:60,\r\n\t\t\t\t\t\tsuccess: (res)=> {\r\n\t\t\t\t\t\t\t// self.src = res.tempFilePath;\r\n\t\t\t\t\t\t\t// 渲染页面\r\n\t\t\t\t\t\t\tthis.send('video', res.tempFilePath);\r\n\t\t\t\t\t\t\t// 发送到服务端（获取视频封面，返回url）\r\n\t\t\t\t\t\t\t// 修改本地的发送状态\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// this.send('emoticon', e.icon);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'sendEmoticon': //发送表情包\r\n\t\t\t\t\tthis.send('emoticon', e.icon);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 预览图片\r\n\t\tpreviewImages(url) {\r\n\t\t\tuni.previewImage({\r\n\t\t\t\tcurrent: url,\r\n\t\t\t\turls: this.imageList,\r\n\t\t\t\tindicator: 'default'\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 切换音频录制和文本输入\r\n\t\tchangeVoiceOrText() {\r\n\t\t\tthis.mode = this.mode !== 'audio' ? 'audio' : 'text';\r\n\t\t},\r\n\t\t// 录音相关\r\n\t\tvoiceTouchStart(e) {\r\n\t\t\t//初始化\r\n\t\t\tthis.isRecording = true;\r\n\t\t\tthis.RecordingStartY =\r\n\t\t\t\te.changedTouches[0].screenY || e.changedTouches[0].pageY;\r\n\t\t\tthis.unRecord = false;\r\n\t\t\t// 开始录音\r\n\t\t\tthis.RECORD.start({\r\n\t\t\t\tformat: 'mp3'\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 录音结束\r\n\t\tvoiceTouchEnd() {\r\n\t\t\tthis.isRecording = false;\r\n\t\t\t// 停止录音\r\n\t\t\tthis.RECORD.stop();\r\n\t\t},\r\n\t\t// 录音被打断 取消发送\r\n\t\tvoiceTouchCancel() {\r\n\t\t\tthis.isRecording = false;\r\n\t\t\tthis.unRecord = true;\r\n\t\t\t// 停止录音\r\n\t\t\tthis.RECORD.stop();\r\n\t\t},\r\n\t\tvoiceTouchMove(e) {\r\n\t\t\tlet RecordingEndY =\r\n\t\t\t\te.changedTouches[0].screenY || e.changedTouches[0].pageY;\r\n\t\t\tlet Y = Math.abs(RecordingEndY - this.RecordingStartY);\r\n\t\t\tthis.unRecord = Y >= 60;\r\n\t\t},\r\n\t\t// 打开聊天信息设置\r\n\t\topenChatSet(){\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl:'../chat-set/chat-set'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n@import '@/common/free.css';\r\n@import '@/common/common.css';\r\n/* #ifndef APP-PLUS-NVUE */\r\n@import '@/common/free-icon.css';\r\n/* #endif*/\r\n\r\n.hiddenScrollbar ::-webkit-scrollbar {\r\n\twidth: 0;\r\n\theight: 0;\r\n\tcolor: transparent;\r\n}\r\n</style>\n","import mod from \"-!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.nvue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.nvue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1617180249334\n      var cssReload = require(\"D:/软件/HBuilderX.2.9.8.20201110/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import mod from \"-!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.nvue?vue&type=style&index=1&id=411c1acd&scoped=true&lang=css&\"; export default mod; export * from \"-!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\软件\\\\HBuilderX.2.9.8.20201110\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.nvue?vue&type=style&index=1&id=411c1acd&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1617180249423\n      var cssReload = require(\"D:/软件/HBuilderX.2.9.8.20201110/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}